
window.onload = function (e) {
    var url = window.location.href;
    if (MemberCustomerID != "0" && MemberCustomerID != 0) {
        if (MemberCustomerID.indexOf(".") < 0) {
            if (url.indexOf("phap-luat/tim-van-ban.aspx") <= 0 && url.indexOf("page/searchfast.aspx") <= 0 && url.indexOf("/van-ban/") <= 0 && url.indexOf("/cong-van/") <= 0 && url.indexOf("/TCVN/") <= 0 && url.indexOf("law-viet-nam/search-document.aspx") <= 0 && url.indexOf("en/searchfast.aspx") <= 0) {
                AddCustomerAction(0, 1000, window.location.href);
            }
        }
    }
}



var _LawID = "";
var _ActionType = [-1];
var _ActionMessage = "";

function AddCustomerAction(LawID, ActionType, ActionMessage) {

    if (MemberCustomerID != "0" && MemberCustomerID != 0 && MemberCustomerID != 68624 && MemberCustomerID != "68624") {
        if ((LawID != _LawID || !checkAc(ActionType)) || (!checkAc(ActionType) || ActionMessage != _ActionMessage)) {
            _LawID = LawID;
            
            _ActionType.push(ActionType);

            _ActionMessage = ActionMessage;

            var _token = "";
           
            _token = getCookie("token");

            var params = "CustomerID=" + MemberCustomerID + "&LawID=" + LawID + "&ActionType=" + ActionType + "&ActionMessage=" + ActionMessage + "&token=" + _token;
           
            $.ajax({ 'url': '//addlog.thuvienphapluat.vn/ajaxcontroler.aspx',
                'data': params + '&action=AddCustomerAction',
                'type': 'POST',
                success: function (response) {
                },
                error: function (response) {
                }
            });
        }
    }
}

function getCookie(cname) {
    var name = cname + "=";
    var decodedCookie = decodeURIComponent(document.cookie);
    var ca = decodedCookie.split(';');
    for (var i = 0; i < ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') {
            c = c.substring(1);
        }
        if (c.indexOf(name) == 0) {
            return c.substring(name.length, c.length);
        }
    }
    return "";
}

function checkAc(ac) {
    var cc = false;
    _ActionType.forEach(function myfunction(item, index) {
        if (item == ac)
            cc = true;
    });
    return cc;
}

function AddKeyword(keyword) {
    var params = "keyword=" + keyword;
    $.ajax({ 'url': '//addlog.thuvienphapluat.vn/ajaxcontroler.aspx',
        'data': params + '&action=AddKeyword',
        'type': 'POST',
        success: function (response) {
        },
        error: function (response) {
        }
    });
}

function AddKeywordLaws(keyword, lawid, position) {
    var params = "keyword=" + keyword + "&lawid=" + lawid + "&position=" + position;
    $.ajax({ 'url': '//addlog.thuvienphapluat.vn/ajaxcontroler.aspx',
        'data': params + '&action=AddKeywordLaws',
        'type': 'POST',
        success: function (response) {
        },
        error: function (response) {
        }
    });
}



function ShowCountIP(NumUser) {
    var params = "CustomerID=" + MemberCustomerID + "&NumUser=" + NumUser;
    $.ajax({ 'url': 'https://addlog.thuvienphapluat.vn/ajaxcontroler.aspx',
        'data': params + '&action=CountIP',
        'type': 'POST',
        success: function (response) {
            if (response != "0" && response != 0) {
                $("#error-dialog-form").html("<p style='line-height: 20px;'>Tài khoản này đã đăng nhập trên " + response + " thiết bị / IP trong 24 giờ qua</p>");
                $("#error-dialog-form").dialog("open");
            }
        },
        error: function (response) {
        }
    });
}

/*
Support for google apps
info@thuvienphapluat.vn
*/

//function S_VBPL(memtype) {
//    _gaq.push(['_trackEvent', 'Search', 'Văn bản Pháp Luật', memtype]);
//}
//function S_CV(memtype) {
//    _gaq.push(['_trackEvent', 'Search', 'Công văn', memtype]);
//}

//function S_TTHC(memtype) {
//    _gaq.push(['_trackEvent', 'Search', 'Thủ tục hành chính', memtype]);
//}

//function S_DL(memtype) {
//    _gaq.push(['_trackEvent', 'Search', 'Tư vấn pháp luật', memtype]);
//}

//function S_News(memtype) {
//    _gaq.push(['_trackEvent', 'Search', 'Thời sự pháp luật', memtype]);
//}
//function SF_TDAP(memtype) {
//    _gaq.push(['_trackEvent', 'Search', 'Tìm nhanh-Thời điểm Áp dụng', memtype]);
//}
//function SF_TTHL(memtype) {
//    _gaq.push(['_trackEvent', 'Search', 'Tìm nhanh-Tình trạng Hiệu lực', memtype]);
//}
//function SF_LV(memtype) {
//    _gaq.push(['_trackEvent', 'Search', 'Tìm nhanh-Lĩnh vực, Ngành', memtype]);
//}
//function SF_TG(memtype) {
//    _gaq.push(['_trackEvent', 'Search', 'Tìm nhanh-Thời gian Ban hành', memtype]);
//}
//function S_TCVN(memtype) {
//    _gaq.push(['_trackEvent', 'Search', 'TCVN', memtype]);
//}

//function Doc_CT(memtype) {
//    _gaq.push(['_trackEvent', 'Document', 'Nội dung', memtype]);
//}

//function Doc_EN(memtype) {
//    _gaq.push(['_trackEvent', 'Document', 'Tiếng Anh', memtype]);
//}
//function Doc_Scan(memtype) {
//    _gaq.push(['_trackEvent', 'Document', 'Văn bản gốc', memtype]);
//}

//function Doc_Rel(memtype) {
//    _gaq.push(['_trackEvent', 'Document', 'Lược đồ', memtype]);
//}

//function Doc_ST(memtype) {
//    _gaq.push(['_trackEvent', 'Document', 'Liên quan hiệu lực', memtype]);
//}
//function Doc_Free(memtype) {
//    _gaq.push(['_trackEvent', 'Document', 'Xem miễn phí', memtype]);
//}
//function Doc_STCT(memtype) {
//    _gaq.push(['_trackEvent', 'Document', 'Liên quan nội dung', memtype]);
//}

//function Doc_Prop(memtype) {
//    _gaq.push(['_trackEvent', 'Document', 'Thuộc tính', memtype]);
//}
//function Doc_DL(memtype) {
//    _gaq.push(['_trackEvent', 'Document', 'Tải về', memtype]);
//}
//function Doc_DLVN(memtype) {
//    _gaq.push(['_trackEvent', 'Document', 'Tải văn bản Tiếng Việt', memtype]);
//}
//function Doc_DLVNML(memtype) {
//    _gaq.push(['_trackEvent', 'Document', 'Tải văn bản Tiếng Việt có mục lục', memtype]);
//}
//function Doc_DLEN(memtype) {
//    _gaq.push(['_trackEvent', 'Document', 'Tải văn bản Tiếng Anh', memtype]);
//}
//function Doc_DLScan(memtype) {
//    _gaq.push(['_trackEvent', 'Document', 'Tải văn bản Gốc', memtype]);
//}
//function Doc_DLAT(memtype) {
//    _gaq.push(['_trackEvent', 'Document', 'Tải văn Đính kèm', memtype]);
//}
//function Doc_ViewNews(memtype) {
//    _gaq.push(['_trackEvent', 'Document', 'Xem Văn bản mới', memtype]);
//}
//function Reg_Free(memtype) {
//    _gaq.push(['_trackEvent', 'Register', 'Đăng ký Free', memtype]);
//}
//function Reg_Pro(memtype) {
//    _gaq.push(['_trackEvent', 'Register', 'Đăng ký Pro', memtype]);
//}
//function Reg_Basic(memtype) {
//    _gaq.push(['_trackEvent', 'Register', 'Đăng ký Basic', memtype]);
//}

function S_VBPL(memtype) {
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Tim kiếm Văn bản Pháp Luật']);
}
function S_CV(memtype) {
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Tim kiếm Công văn']);
}

function S_TTHC(memtype) {
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Tim kiếm Thủ tục hành chính']);
}

function S_DL(memtype) {
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Tim kiếm Tư vấn pháp luật']);
}

function S_News(memtype) {
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Tim kiếm Thời sự pháp luật']);
}
function SF_TDAP(memtype) {
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Tìm nhanh-Thời điểm Áp dụng']);
}
function SF_TTHL(memtype) {
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Tìm nhanh-Tình trạng Hiệu lực']);
}
function SF_LV(memtype) {
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Tìm nhanh-Lĩnh vực, Ngành']);
}
function SF_TG(memtype) {
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Tìm nhanh-Thời gian Ban hành']);
}
function S_TCVN(memtype) {
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Tim kiếm TCVN']);
}



function Doc_CT(memtype) {
    rt_action_tab += "[Xem Nội dung VB]";
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Xem Nội dung']);
}
function Doc_EN(memtype) {
    rt_action_tab += "[Xem Nội dung Tiếng Anh]";
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Xem Tiếng Anh']);
}
function Doc_Scan(memtype) {
    rt_action_tab = "[Xem Văn bản gốc]";
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Xem Văn bản gốc']);
}
function Doc_Rel(memtype) {
    rt_action_tab += "[Xem Lược đồ]";
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Xem Lược đồ']);
}
function Doc_Rel_Link(memtype) {
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Xem VB trong lược đồ']);
}
function Doc_Rel_Link_TTHC(memtype) {
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Xem Thủ Tục Hành Chính liên quan trong lược đồ']);
}
function Doc_ST(memtype) {
    rt_action_tab += "[Xem Liên quan hiệu lực]";
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Xem Liên quan hiệu lực']);
}
function Doc_Free(memtype) {
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Xem miễn phí']);
}
function Doc_STCT(memtype) {
    rt_action_tab += "[Xem Liên quan nội dung]";
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Xem Liên quan nội dung']);
}
function Doc_Prop(memtype) {
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Xem Thuộc tính']);
}
function Doc_DL(memtype) {
    rt_action_tab += "[Tải văn bản]";
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Tải về']);
}
function Doc_DLVN(memtype) {
    rt_action_tab += "[Tải văn bản]";
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Tải văn bản Tiếng Việt']);
}
function Doc_DLVNML(memtype) {
    rt_action_tab += "[Tải văn bản]";
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Tải văn bản Tiếng Việt có mục lục']);
}
function Doc_DLEN(memtype) {
    rt_action_tab += "[Tải văn bản TA]";
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Tải văn bản Tiếng Anh']);
}
function Doc_DLScan(memtype) {
    rt_action_tab = "[Tải văn bản Gốc]";
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Tải văn bản Gốc']);
}
function Doc_DLAT(memtype) {
    rt_action_tab += "[Tải văn bản]";
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Tải văn Đính kèm']);
}
function Doc_ViewNews(memtype) {
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Xem Văn bản mới']);
}


function Reg_Free(memtype) {
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Đăng ký Free']);
}
function Reg_Pro(memtype) {
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Đăng ký Pro']);
}
function Reg_Basic(memtype) {
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Đăng ký Basic']);
}


function View_XongNgu(memtype) {
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Xem VB xong ngữ']);
}
function View_MucLuc(memtype) {
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Xem Mục lục VB']);
}
function View_NDSD(memtype) {
    _gaq.push(['_trackEvent', 'UserActivity', memtype, 'Xem nội dung VB bị sửa đổi']);
}