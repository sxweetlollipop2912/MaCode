E. Blood Cousins (binary search, dfs & similar, trees...)
http://codeforces.com/problemset/problem/208/E

